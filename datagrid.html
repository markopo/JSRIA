<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
<head>
    <title>Untitled Page</title>
    <script type="text/javascript">
        var DATAGRID = (function (ds) {
            this.ds = ds;
            var props = [];

            var obj = ds[0];
            for (var i in obj) {
                if (i != "id") {
                    props.push(i);
                }
            }

            function iterate(id) {
                var obj = null;
                var len = ds.length;
                for (var i = 0; i < len; i++) {
                    if (ds[i].id == id) {
                        obj = ds[i];
                        break;
                    }
                }
                return obj;
            }

            function buildtable() {
                var dslen = ds.length;
                var propslen = props.length;
                var table = document.createElement("table");

                var thead = document.createElement("thead");
                table.appendChild(thead);

                var tbody = document.createElement("tbody");
                table.appendChild(tbody);

                for (var i = 0; i < dslen; i++) {
                    var tr = document.createElement("tr");
                    tr.id = ds[i].id;

                    for (var j = 0; j < propslen; j++) {
                        var td = document.createElement("td");
                        var text = document.createElement("input");
                        text.onfocus = function () {
                            var value = this.value;
                            var id = this.id;
                        }
                        text.onblur = function () {
                            var falt = this.className;
                            var value = this.value;
                            var id = this.parentNode.parentNode.id;
                            alert(id + " / " + falt + " / " + value);
                        }
                        text.className = props[j];
                        text.value = ds[i][props[j]];
                        td.appendChild(text);
                        tr.appendChild(td);
                    }
                    tbody.appendChild(tr);
                }
                return table;
            }


            return {
                editing: function (id) {
                    return iterate(id);
                },
                deleting: function (id) {

                },
                adding: function (obj) {

                },
                table: function () {
                    return buildtable();
                }
            }

        });


        window.onload = function () {
            var ds = [];
            for (var i = 0; i < 100; i++) {
                var obj = { id: i, name: "marko", age: Math.round((Math.random() * i * 0.5) + (15)), height: Math.round(150 + i * 0.5).toString() + "cm" };
                ds.push(obj); 
            }

            var grid = new DATAGRID(ds);

            //DATAGRID(ds, "hej");

            document.body.appendChild(grid.table());

        }
    
    
    
    </script>

</head>
<body>
    <table id="mytable">
        <thead>
            <tr>
              <th></th>  
              <th></th>  
              <th></th>  
              <th></th>  
            </tr>
        </thead>
        <tbody>
           <tr id="1">
              <td></td>
           </tr> 
        
        
        </tbody>    
    </table>


  

</body>
</html>
